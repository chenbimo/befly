# Befly Monorepo å‘ç‰ˆé…ç½®è¯´æ˜

## æ ¸å¿ƒä¾èµ–ï¼ˆæœ€ç²¾ç®€ï¼‰

```json
{
    "devDependencies": {
        "@lerna-lite/cli": "4.9.0", // Lerna æ ¸å¿ƒ CLI
        "@lerna-lite/publish": "4.9.0", // npm å‘å¸ƒåŠŸèƒ½
        "@lerna-lite/version": "4.9.0" // ç‰ˆæœ¬ç®¡ç†
    }
}
```

## ä¸ºä»€ä¹ˆè¿™æ ·ç²¾ç®€ï¼Ÿ

1. **Bun Workspaces**: Bun åŸç”Ÿæ”¯æŒ monorepoï¼Œæ— éœ€é¢å¤–å·¥å…·
2. **åªéœ€å‘ç‰ˆ**: åªä¿ç•™ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒç›¸å…³çš„åŒ…
3. **çº¯ç²¹å‘å¸ƒ**: ä¸ç”Ÿæˆ CHANGELOGï¼Œä¸åˆ›å»º git tag

## å‘ç‰ˆæµç¨‹

### æ–¹å¼ä¸€ï¼šä½¿ç”¨å‘å¸ƒè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# ä¸€é”®å‘å¸ƒï¼ˆäº¤äº’å¼æŒ‡å®šç‰ˆæœ¬ï¼‰
bun run temp/publish.js
```

ç‰¹ç‚¹ï¼š

-   âœ… åªå‘å¸ƒæœ‰æ”¹åŠ¨çš„åŒ…
-   âœ… æ‰‹åŠ¨æŒ‡å®šæ¯ä¸ªåŒ…çš„ç‰ˆæœ¬å·
-   âœ… ä¸ç”Ÿæˆ CHANGELOG
-   âœ… ä¸åˆ›å»º git tag
-   âœ… ä¸æ¨é€åˆ° git

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨åˆ†æ­¥æ‰§è¡Œ

```bash
# 1. æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬å·
bun run version

# 2. å‘å¸ƒåˆ° npm
bun run publish
```

### æ–¹å¼ä¸‰ï¼šCI/CD è‡ªåŠ¨å‘å¸ƒ

```bash
bun run publish:ci
```

## publish.js è„šæœ¬åŠŸèƒ½

çº¯ç²¹ npm å‘å¸ƒæµç¨‹ï¼š

1. ğŸ§ª è¿è¡Œæµ‹è¯•
2. ğŸ“ æ‰‹åŠ¨æŒ‡å®šç‰ˆæœ¬å·ï¼ˆäº¤äº’å¼ï¼‰
3. ğŸ“¤ å‘å¸ƒåˆ° npmï¼ˆLerna è‡ªåŠ¨æ£€æµ‹æœ‰æ”¹åŠ¨çš„åŒ…ï¼‰

## å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰åŒ…
bun run list

# æŸ¥çœ‹å“ªäº›åŒ…æœ‰å˜æ›´
bun run changed

# æœ¬åœ°å¼€å‘
bun run dev

# è¿è¡Œæµ‹è¯•
bun run test
```

## é…ç½®æ–‡ä»¶è¯´æ˜

-   `lerna.json` - Lerna å‘ç‰ˆé…ç½®
-   `package.json` - æ ¹å·¥ä½œåŒºé…ç½®
-   `.npmrc` - npm æ³¨å†Œè¡¨é…ç½®
-   `release.js` - è‡ªåŠ¨åŒ–å‘ç‰ˆè„šæœ¬

## æ³¨æ„äº‹é¡¹

1. ä½¿ç”¨ `independent` ç‰ˆæœ¬æ¨¡å¼ï¼Œæ¯ä¸ªåŒ…ç‹¬ç«‹ç‰ˆæœ¬
2. éµå¾ª Conventional Commits è§„èŒƒè‡ªåŠ¨ç”Ÿæˆ CHANGELOG
3. tpl åŒ…é€šè¿‡ `workspace:*` å¼•ç”¨æœ¬åœ° core åŒ…
4. å‘å¸ƒæ—¶ä¼šè‡ªåŠ¨å¿½ç•¥ `.md`ã€`.test.ts` ç­‰æ–‡ä»¶çš„å˜æ›´
