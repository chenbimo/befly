# 安装与环境

> 目标：5 分钟完成环境准备，能够在 `tpl/` 模板项目中启动 Befly 并访问一个 API。

## 先决条件

-   Bun（必需）。建议版本 ≥ 1.1。Windows 用户可参考 https://bun.sh 安装。
-   Git（推荐）。
-   数据库（可选）：
    -   快速体验：无需数据库，直接跑 HTTP 服务；
    -   想体验 DB：准备 SQLite 文件，或本地 MySQL 8+/PostgreSQL 17+。

## 获取仓库

-   已有本仓库：直接使用。
-   新项目：可基于 `tpl/` 模板启动。

## 目录结构（顶层）

-   `core/` Befly 框架源码，将作为依赖被 `tpl/` 引用
-   `tpl/` 模板/示例项目，独立运行，默认依赖 `../core`
-   `docs/` 使用手册（当前文档）

## 运行前的最小配置

-   初次体验无需配置（不连接数据库）。
-   若要使用数据库，请设置 DB\_\* 变量。示例（MySQL）：

```
# pm2 或你的环境变量中设置
DB_ENABLE=1
DB_TYPE=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_USER=root
DB_PASS=root
DB_NAME=demo
DB_POOL_MAX=10
DB_DEBUG=0
```

更多 DB\_\* 说明见“05-数据库/01-DB 配置.md”。

## 在模板项目启动

在 Windows 的 cmd 中：

```
cd tpl
bun run dev
```

看到日志中有“服务器已启动: http://...”/“Befly 服务器启动成功”即表示成功。

## 访问服务

-   根路径：`GET /` 返回 { code:0, msg:'Befly 接口服务已启动', ... }
-   健康检查：`POST /api/core/health/info`

## 进程守护（可选）

模板已提供 pm2 配置：`tpl/pm2.config.cjs`，内置 Befly 常用环境变量。生产可用：

```
cd tpl
bunx --bun pm2 start pm2.config.cjs -a
```

## 常见安装问题

-   Bun 未找到：请确认 PATH 配置或重启终端。
-   Windows 权限：如端口占用，换个端口设置 APP_PORT；或以管理员终端运行。
-   MySQL 版本：小于 8 或 MariaDB 将被拒绝用于同步脚本。
