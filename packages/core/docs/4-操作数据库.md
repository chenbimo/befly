è¦æ“ä½œæ•°æ®ï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ª`env.ts` æˆ– `env.js` æ–‡ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
import type { EnvConfig } from './types/env.js';

export const Env: Partial<EnvConfig> = {
    // å¯ç”¨æ•°æ®åº“
    DATABASE_ENABLE: 1,
    // æ•°æ®åº“é…ç½®
    DB_TYPE: 'mysql',
    DB_HOST: '127.0.0.1',
    DB_PORT: 3306,
    DB_USER: 'root',
    DB_PASS: 'root',
    DB_NAME: 'befly_demo',
    // Redis é…ç½®
    REDIS_HOST: '127.0.0.1',
    REDIS_PORT: 6379,
    REDIS_USERNAME: '',
    REDIS_PASSWORD: '',
    REDIS_DB: 0,
    REDIS_KEY_PREFIX: 'befly_demo'
};
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®åº“é…ç½®å’Œ Redis ç¼“å­˜é…ç½®éƒ½è¦è®¾ç½®ï¼Œä¸èƒ½åªè®¾ç½®ä¸€ä¸ªï¼Œ`DATABASE_ENABLE` è®¾ç½®ä¸º `1` åï¼Œå°†ä¼šå¼€å¯æ•°æ®åº“åŠŸèƒ½ï¼Œå¦‚æœé…ç½®é”™è¯¯åˆ™ä¼šæŠ¥é”™ï¼Œé…ç½®æ­£ç¡®å†æ¬¡è¿è¡Œ `bun run main.ts` åˆ™ä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼š

```bash
D:\codes\_test\t10>bun run index.ts
[2025-11-19 20:33:09]  INFO - é‡èœ‚é£èˆå¼€å‘ç¯å¢ƒ æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ!
[2025-11-19 20:33:09]  INFO - æœåŠ¡å™¨å¯åŠ¨è€—æ—¶: 2.04 æ¯«ç§’
[2025-11-19 20:33:09]  INFO - æœåŠ¡å™¨ç›‘å¬åœ°å€: http://127.0.0.1:3000
```

å¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰ `æ•°æ®åº“æœªå¯ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–` å’Œ `Redis æœªå¯ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–` çš„æç¤ºä¿¡æ¯äº†ã€‚

æ­£ç¡®é…ç½®å’Œè¿æ¥æ•°æ®åº“åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è®¾è®¡`æ•°æ®åº“è¡¨ç»“æ„äº†`ï¼ŒåŒæ ·ä¹Ÿæ˜¯ `çº¦å®šå¤§äºé…ç½®` çš„æ€è·¯ï¼Œ`æ•°æ®åº“å­—æ®µ` å…¨éƒ¨åœ¨ æ ¹ç›®å½•ä¸‹çš„ `tables` ç›®å½•ä¸‹åˆ›å»ºå’Œå®šä¹‰ã€‚

```bash
befly-demo/
â”œâ”€â”€ apis
â”‚   â”œâ”€â”€ echo.ts     # å¤è¯»æœºæ¥å£
â”‚   â””â”€â”€ save.ts     # ä¿å­˜æ¥å£
â”œâ”€â”€ tables
â”‚   â””â”€â”€ info.json     # ä¿¡æ¯è¡¨
â”œâ”€â”€ node_modules
â”œâ”€â”€ bun.lock
â”œâ”€â”€ index.ts
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

å¦‚ä¸Šï¼Œåœ¨ `tables` ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ª `info.json` è¡¨ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š

```json
{
    "name": {
        "name": "å§“å",
        "type": "string",
        "min": 2,
        "max": 50
    },
    "code": {
        "name": "å¹´é¾„",
        "type": "number",
        "min": 0,
        "max": 120
    },
    "value": {
        "name": "èº«é«˜",
        "type": "number",
        "min": 0,
        "max": 300
    },
    "sort": {
        "name": "ä½“é‡",
        "type": "number",
        "min": 0,
        "max": 9999
    }
}
```

`befly` çš„è¡¨ç»“æ„å®šä¹‰å…¨éƒ¨åœ¨æ–‡ä»¶ä¸­å®šä¹‰å³å¯ï¼Œé‚£ä¹ˆè¦åŒæ­¥åˆ°æ•°æ®åº“ä¸­ï¼Œéœ€è¦ç”¨åˆ° `befly-cli` ä¾èµ–ï¼Œä½¿ç”¨ `bun add befly-cli` å®‰è£…å³å¯ã€‚

å®‰è£…å®Œæ¯•åï¼Œæ‰§è¡Œ `bunx befly sync` å‘½ä»¤ï¼ŒåŒæ­¥æ•°æ®åº“å­—æ®µåˆ°çœŸå®æ•°æ®åº“ä¸­ï¼Œç»ˆç«¯æ˜¾ç¤ºçš„å†…å®¹å¦‚ä¸‹ï¼š

```bash
D:\codes\_test\t10>bunx befly sync
========================================
å¼€å§‹æ‰§è¡Œå®Œæ•´åŒæ­¥æµç¨‹
å½“å‰ç¯å¢ƒ: development
é¡¹ç›®åç§°: é‡èœ‚é£èˆå¼€å‘ç¯å¢ƒ
æ•°æ®åº“åœ°å€: 127.0.0.1
æ•°æ®åº“åç§°: befly_demo
========================================

ğŸ” æ­£åœ¨æ£€æŸ¥é¡¹ç›®ç»“æ„...
âœ“ é¡¹ç›®ç»“æ„æ£€æŸ¥å®Œæˆ

å¼€å§‹æ‰§è¡ŒåŒæ­¥ä»»åŠ¡...

ğŸ“¦ æ­£åœ¨åŒæ­¥æ•°æ®åº“...
MySQL ç‰ˆæœ¬: 8.0.31
ğŸ§¹ æ¸…ç† 1 ä¸ªè¡¨çš„å­—æ®µç¼“å­˜...
âœ“ å·²æ¸…ç†è¡¨å­—æ®µç¼“å­˜
âœ“ æ•°æ®åº“åŒæ­¥å®Œæˆ

ğŸ”Œ æ­£åœ¨åŒæ­¥æ¥å£...
è¡¨ addon_admin_api ä¸å­˜åœ¨ï¼Œè·³è¿‡ API åŒæ­¥ï¼ˆéœ€è¦å®‰è£… addon-admin ç»„ä»¶ï¼‰
âœ“ æ¥å£åŒæ­¥å®Œæˆ

ğŸ“‹ æ­£åœ¨åŒæ­¥èœå•...
è¡¨ addon_admin_menu ä¸å­˜åœ¨ï¼Œè·³è¿‡èœå•åŒæ­¥ï¼ˆéœ€è¦å®‰è£… addon-admin ç»„ä»¶ï¼‰
âœ“ èœå•åŒæ­¥å®Œæˆ

ğŸ‘¤ æ­£åœ¨åŒæ­¥å¼€å‘è´¦å·...
âœ“ å¼€å‘è´¦å·åŒæ­¥å®Œæˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… åŒæ­¥å®Œæˆï¼æ€»è€—æ—¶: 0.08 ç§’
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

åŒæ­¥å®Œæ¯•åï¼Œä½¿ç”¨æ•°æ®åº“å·¥å…·æŸ¥çœ‹ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ `HeidiSQL`ï¼Œå¦‚ä¸‹å›¾ã€‚

![](https://static.yicode.tech/images/202511/20251119225701.png)

éœ€è¦æ³¨æ„ï¼Œæ”¹åŠ¨æ•°æ®åº“å®šä¹‰åï¼Œéƒ½è¦æ‰§è¡Œ `bunx befly sync` å‘½ä»¤åŒæ­¥åˆ°å®é™…æ•°æ®åº“ç»“æ„ä¸­æ‰ä¼šç”Ÿæ•ˆã€‚

æ•°æ®åº“åŒæ­¥å®Œæ¯•ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å†™ä¿å­˜ä¿¡æ¯æ¥å£ `apis/save.ts`ï¼Œæ¥æ”¶ä»å®¢æˆ·ç«¯ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå¦‚ä¸‹ï¼š

```js
import { Yes } from "befly";
import infoTable from "../tables/info.json";

export default {
    name: "ä¿å­˜ä¿¡æ¯æ¥å£",
    method: "get",
    auth: false,
    fields: infoTable,
    handler: async (befly, ctx) => {
        const res = await befly.db.insData({
            table: "info",
            data: {
                name: ctx.body.name,
                age: ctx.body.age,
                height: ctx.body.height,
                weight: ctx.body.weight
            }
        });
        return Yes("ä¿¡æ¯ä¿å­˜æˆåŠŸ", {
            id: 17635656770001
        });
    }
};
```

åœ¨æµè§ˆå™¨è®¿é—® `http://127.0.0.1:3000/api/save?name=å¼ ä¸‰&age=18&height=160&weight=70`ï¼Œè¿”å›å†…å®¹å¦‚ä¸‹å›¾ã€‚

![](https://static.yicode.tech/images/202511/20251119232313.png)

åŒæ—¶å‘¢ï¼ŒæŸ¥çœ‹æ•°æ®åº“çš„ `info` è¡¨æ•°æ®åº“ï¼Œå¦‚ä¸‹å›¾ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®å·²ç»æ­£ç¡®ä¿å­˜åˆ°äº†æ•°æ®åº“ä¸­ã€‚

![](https://static.yicode.tech/images/202511/20251119232426.png)

è¿™å°±æ˜¯ä½¿ç”¨`Befly`æ¡†æ¶æ¥å†™æ¥å£ï¼Œæ“ä½œæ•°æ®åº“çš„åŸºæœ¬æµç¨‹ï¼Œç®€å•æ¥è¯´å…¶å®åªæœ‰ 2 ä¸ªä¸»è¦æ­¥éª¤ã€‚

1. å®šä¹‰æ•°æ®åº“è¡¨ï¼ŒåŒæ­¥è¡¨ç»“æ„ã€‚
2. å†™å¢åˆ æ”¹æŸ¥æ¥å£ï¼Œæ“ä½œæ•°æ®åº“ã€‚

è¿™å°±æ˜¯ `Belfy` çš„æç®€ä¸»ä¹‰ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šèŠ±é‡Œèƒ¡å“¨çš„æ¦‚å¿µï¼Œå½“ç„¶æ›´å¤šä½¿ç”¨å’Œé…ç½®ç»†èŠ‚ï¼Œå°†åœ¨åç»­æ–‡ç« ä¸€ä¸€è¯´æ˜ã€‚
